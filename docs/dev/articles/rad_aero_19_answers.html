<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introductory exercises with bioRad • bioRad</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Introductory exercises with bioRad">
<meta property="og:description" content="">
<meta property="og:image" content="https://adokter.github.io/bioRad/logo.png">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bioRad</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.4.0.9243</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/bioRad.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/rad_aero_19.html">Introductory exercises with bioRad</a>
    </li>
    <li>
      <a href="../articles/rad_aero_19_answers.html">Introductory exercises with bioRad</a>
    </li>
    <li>
      <a href="../articles/range_correction.html">Correction for range effects</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/adokter/bioRad">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introductory exercises with bioRad</h1>
                        <h4 class="author">Adriaan M. Dokter</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/adokter/bioRad/blob/master/vignettes/rad_aero_19_answers.Rmd"><code>vignettes/rad_aero_19_answers.Rmd</code></a></small>
      <div class="hidden name"><code>rad_aero_19_answers.Rmd</code></div>

    </div>

    
    
<p><em>These course materials were developed for the 3d Radar Aeroecology Training School, Jul 30 - Aug 2 2019, University of Oklahoma, Norman, OK, USA.</em></p>
<div id="basic-visualisation-of-radar-scans-in-r" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-visualisation-of-radar-scans-in-r" class="anchor"></a>1 Basic visualisation of radar scans in R</h2>
<div id="preparation" class="section level3">
<h3 class="hasAnchor">
<a href="#preparation" class="anchor"></a>1.1 Preparation</h3>
<p>Radar data needed for this practical can be downloaded <a href="https://www.dropbox.com/sh/hghu27u9zsqljsj/AABZSvoq1gEJ_OSVJpn2jzs9a?dl=0">here</a>.</p>
<p>Follow bioRad’s <a href="http://adokter.github.io/bioRad/dev">install instructions</a>, and install the latest development version to be fully up-to-date.</p>
<p>Execute each of the code examples provided below in <a href="https://www.rstudio.com/">RStudio</a>, and try to complete the exercises.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># make sure you start with a fresh R session</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co"># load the bioRad package</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(bioRad)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co"># check the package version</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/packageDescription">packageVersion</a></span>(<span class="st">"bioRad"</span>)</a></code></pre></div>
<pre><code>## [1] '0.4.0.9243'</code></pre>
<p>Make sure you have the latest version (0.4.0.9243). If you have an older version, download and reinstall as follows:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(devtools)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"adokter/bioRad"</span>)</a></code></pre></div>
<p>All bioRad’s functions are documented in an extensive <a href="http://adriaandokter.com/bioRad/dev/reference/index.html">function refererence</a> online, as well as in manual pages within R:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># bring up the package general help page:</span></a>
<a class="sourceLine" id="cb4-2" title="2">?bioRad</a></code></pre></div>
<p>Start by making a new directory on your local machine that you will use for this practical:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># make a new local directory on your machine where to download data for this practical</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co"># replace the string below with the path of that directory:</span></a>
<a class="sourceLine" id="cb5-3" title="3">HOME &lt;-<span class="st"> "your/personal/working/directory/"</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co"># check that the directory exists. If the next statement evaluates to FALSE, something went wrong: the directory does not exist or you didn't specify its path correctly</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/files">file.exists</a></span>(HOME)</a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co"># we will make HOME our work directory, the default folder in which R will look</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co"># for files, and where it will output newly generated files.</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/getwd">setwd</a></span>(HOME)</a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co"># Finally, we set the local time zone to UTC, so all plotted time axes will be in UTC</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Sys.setenv">Sys.setenv</a></span>(<span class="dt">TZ =</span> <span class="st">"UTC"</span>)</a></code></pre></div>
<p>Your R session is now properly set up.</p>
<p>To work with US NEXRAD data, bioRad currently requires a working installation of Docker (Linux/Mac) or Docker for Windows (<strong>not</strong> Docker Toolbox, this is an older implementation of Docker for Windows operating systems that is not supported). If you managed to successfully install Docker, test whether it works:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># start your local Docker installation</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co"># we first test whether R can communicate with Docker:</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw"><a href="../reference/check_docker.html">check_docker</a></span>()</a></code></pre></div>
<pre><code>## Running docker image with vol2bird version 0.4.0</code></pre>
<pre><code>## [1] 0</code></pre>
<p>The message “running docker image with vol2bird version 0.4.0” indicates everything is working.</p>
<p>If you did <strong>not</strong> manage to install Docker, you will be able to continue with all of below exercises, but not be able to load NEXRAD data into R at this time.</p>
</div>
<div id="the-structure-of-polar-volumes" class="section level3">
<h3 class="hasAnchor">
<a href="#the-structure-of-polar-volumes" class="anchor"></a>1.2 The structure of polar volumes</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># the bioRad package comes with an example radar volume file, that we will inspect first</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co"># first locate this example file on our computer:</span></a>
<a class="sourceLine" id="cb9-3" title="3">my_filename &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.file">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"volume.h5"</span>, <span class="dt">package =</span> <span class="st">"bioRad"</span>)</a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co"># print the local path of the volume file:</span></a>
<a class="sourceLine" id="cb9-5" title="5">my_filename</a></code></pre></div>
<pre><code>## [1] "/Library/Frameworks/R.framework/Versions/3.6/Resources/library/bioRad/extdata/volume.h5"</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co"># load the file into R:</span></a>
<a class="sourceLine" id="cb11-2" title="2">my_pvol &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_pvolfile.html">read_pvolfile</a></span>(my_filename)</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co">## print some information about the polar volume</span></a>
<a class="sourceLine" id="cb11-4" title="4">my_pvol</a></code></pre></div>
<pre><code>##                Polar volume (class pvol)
## 
##      # scans:  3 
##        radar:  SE50 
##       source:  WMO:02606,RAD:SE50,PLC:Angelholm,NOD:seang,ORG:82,CTY:643,CMT:Swedish radar 
## nominal time:  2015-10-18 18:00:00</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># print information about the polar scans contained in this polar volume:</span></a>
<a class="sourceLine" id="cb13-2" title="2">my_pvol<span class="op">$</span>scans</a></code></pre></div>
<pre><code>## [[1]]
##                   Polar scan (class scan)
## 
##      parameters:  DBZH VRADH RHOHV ZDR PHIDP 
## elevation angle:  0.5 deg
##            dims:  480 bins x 360 rays
## 
## [[2]]
##                   Polar scan (class scan)
## 
##      parameters:  DBZH VRADH RHOHV ZDR PHIDP 
## elevation angle:  1.5 deg
##            dims:  480 bins x 360 rays
## 
## [[3]]
##                   Polar scan (class scan)
## 
##      parameters:  DBZH VRADH RHOHV ZDR PHIDP 
## elevation angle:  2.5 deg
##            dims:  480 bins x 360 rays</code></pre>
<p><strong>Exercise 1:</strong> Load the polar volume file, <code>example_pvol.h5</code> from the files downloaded in section 1.1. Put it in your working directory and load it into R. What is the minimum and maximum scan elevation contained in the volume? And which scan parameters are available? (See manual page of the <code><a href="../reference/read_pvolfile.html">read_pvolfile()</a></code> function for the nomenclature of various available quantities).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">my_pvol &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_pvolfile.html">read_pvolfile</a></span>(<span class="st">"example_pvol.h5"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># The default summary information of a `pvol` object contains information</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="co"># on the scans (sweeps) and their moments:</span></a>
<a class="sourceLine" id="cb16-3" title="3">my_pvol</a></code></pre></div>
<pre><code>##                Polar volume (class pvol)
## 
##      # scans:  11 
##        radar:  SE50 
##       source:  WMO:02606,RAD:SE50,PLC:Ängelholm,NOD:seang,ORG:82,CTY:643,CMT:Swedish radar 
## nominal time:  2015-09-20 20:00:00</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># We can also extract the elevation angles from the polar volume as follows:</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="kw"><a href="../reference/get_elevation_angles.html">get_elevation_angles</a></span>(my_pvol)</a></code></pre></div>
<pre><code>##  [1]  0.5  0.5  1.0  1.5  2.0  2.5  4.0  8.0 14.0 24.0 40.0</code></pre>
</div>
<div id="plotting-radar-scans" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting-radar-scans" class="anchor"></a>1.3 Plotting radar scans</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="co"># (if you haven't done so already) load the polar volume data from the example_pvol.h5 file you just downloaded</span></a>
<a class="sourceLine" id="cb20-2" title="2">my_pvol &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_pvolfile.html">read_pvolfile</a></span>(<span class="st">"example_pvol.h5"</span>)</a>
<a class="sourceLine" id="cb20-3" title="3"><span class="co"># let's extract the third scan, which was collected at 1.5 degree elevation:</span></a>
<a class="sourceLine" id="cb20-4" title="4">my_scan &lt;-<span class="st"> </span>my_pvol<span class="op">$</span>scans[[<span class="dv">3</span>]]</a>
<a class="sourceLine" id="cb20-5" title="5"><span class="co"># print some information about this scan:</span></a>
<a class="sourceLine" id="cb20-6" title="6">my_scan</a></code></pre></div>
<pre><code>##                   Polar scan (class scan)
## 
##      parameters:  TH VRADH DBZH ZDR RHOHV PHIDP 
## elevation angle:  1 deg
##            dims:  480 bins x 360 rays</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># let's plot the reflectivity factor parameter of the scan in a range - azimuth coordinate system:</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my_scan, <span class="dt">param=</span><span class="st">"DBZH"</span>)</a></code></pre></div>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>Usually it is more intuitive to explore radar scans as a PPI (plan position indicator), which is a projection of the scan on a Cartesian (X,Y) or (lat,lon) grid:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="co"># before we can plot the scan, we need to project it on a Cartesian grid,</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="co"># i.e. we need to make a Plan Position Indicator (PPI)</span></a>
<a class="sourceLine" id="cb23-3" title="3">my_ppi &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project_as_ppi.html">project_as_ppi</a></span>(my_scan)</a>
<a class="sourceLine" id="cb23-4" title="4"><span class="co"># print some information about this ppi:</span></a>
<a class="sourceLine" id="cb23-5" title="5">my_ppi</a></code></pre></div>
<pre><code>##                Plan position indicator (class ppi)
## 
##   quantities:  TH VRADH DBZH ZDR RHOHV PHIDP 
##         dims:  200 x 200 pixels</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co"># you can see we projected it on a 500 meter grid</span></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="co"># (check the manual of the project_as_ppi function to see how you can</span></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="co"># change the grid size (argument grid_size) and the maximum distance</span></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="co"># from the radar up to where to plot data (argument range_max))</span></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="co">#</span></a>
<a class="sourceLine" id="cb25-6" title="6"><span class="co"># Now we are ready to plot the ppi, for example let's plot reflectivity factor DBZH:</span></a>
<a class="sourceLine" id="cb25-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my_ppi, <span class="dt">param =</span> <span class="st">"DBZH"</span>)</a></code></pre></div>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p><strong>Exercise 2:</strong> This case contains convective precipitation, characterized by localized but intense thunderstorms, as well as biological scattering. Make also a ppi plot of the correlation coefficient (RHOHV) and radial velocity (VRADH). Verify how the texture of the radial velocity, and the values of correlation coefficient of the precipitative areas differs from the areas with biological scattering.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co"># Plot the correlation coefficient (RHOHV):</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my_ppi, <span class="dt">param =</span> <span class="st">"RHOHV"</span>)</a></code></pre></div>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co"># Plot the radial velocity (VRADH):</span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my_ppi, <span class="dt">param =</span> <span class="st">"VRADH"</span>)</a></code></pre></div>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co"># Answer:</span></a>
<a class="sourceLine" id="cb28-2" title="2"><span class="co">#</span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="co"># The texture (spatial variability) of the radial velocity is considerably smoother</span></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="co"># in areas with precipitation than in areas with biology. Note: we see this especially</span></a>
<a class="sourceLine" id="cb28-5" title="5"><span class="co"># at C-band radars (as in this example), at S-band the difference can be less clear.</span></a></code></pre></div>
<p><strong>Exercise 3:</strong> Based on the radial velocity image, are the biological scatterers birds or insects? Why?</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co"># Answer:</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="co"># The radial velocity (VRADH) PPI shows that biological scatterers have</span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="co"># a higher speed than the precipitation. This indicates the</span></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="co"># biological scatterers must have a high self-propelled speed, which is</span></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="co"># typical for birds, not for insects.</span></a></code></pre></div>
</div>
<div id="overlaying-radar-scans-on-maps" class="section level3">
<h3 class="hasAnchor">
<a href="#overlaying-radar-scans-on-maps" class="anchor"></a>1.4 Overlaying radar scans on maps</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="co"># It is often informative to plot radar data on a base layer.</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="co"># first download the background image:</span></a>
<a class="sourceLine" id="cb30-3" title="3">basemap &lt;-<span class="st"> </span><span class="kw"><a href="../reference/download_basemap.html">download_basemap</a></span>(my_ppi)</a></code></pre></div>
<pre><code>## Downloading zoom = 9 ...</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/9/273/157.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/9/274/157.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/9/275/157.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/9/273/158.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/9/274/158.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/9/275/158.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/9/273/159.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/9/274/159.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/9/275/159.png</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="co"># then overlay the PPI on the satellite image, restricting the color scale from -20 to 15 dBZ:</span></a>
<a class="sourceLine" id="cb41-2" title="2"><span class="kw"><a href="../reference/map.html">map</a></span>(my_ppi, <span class="dt">map =</span> basemap, <span class="dt">param =</span> <span class="st">"DBZH"</span>, <span class="dt">zlim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">20</span>, <span class="dv">15</span>))</a></code></pre></div>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>bioRad provides several functions to convert radar scans to other common spatial formats in R (cf. package <code>raster</code> and package <code>sp</code>), see <code><a href="../reference/scan_to_raster.html">scan_to_raster()</a></code> and <code><a href="../reference/scan_to_spatial.html">scan_to_spatial()</a></code>, allowing you to process and overlay the radar data further with these spatial analysis toolkits.</p>
</div>
</div>
<div id="analysis-and-visualisation-of-vertical-bird-profiles" class="section level2">
<h2 class="hasAnchor">
<a href="#analysis-and-visualisation-of-vertical-bird-profiles" class="anchor"></a>2 Analysis and visualisation of vertical bird profiles</h2>
<p>In this section you will learn to compute, interpret and analyze vertical profiles (vp). A vp consists of the (bird) density, speed and directions at different altitudes at the location of a single radar. It is typically calculated for all data within a cylinder of 35 km radius around the radar, i.e. only containing data at relatively short distances, where the radar beam is still sufficiently narrow to resolve altitude information.</p>
<p>Section 3 has examples that show how to process polar volume data into vertical profiles. To save time, we will start below with a list of pre-processed vertical profiles for the Brownsville radar in Texas (KBRO).</p>
<div id="loading-processed-vertical-profiles" class="section level3">
<h3 class="hasAnchor">
<a href="#loading-processed-vertical-profiles" class="anchor"></a>2.1 Loading processed vertical profiles</h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="co"># Usually we would load processed vertical profiles (vp files) by:</span></a>
<a class="sourceLine" id="cb42-2" title="2"><span class="co"># my_vplist &lt;- read_vpfiles("./your/directory/with/processed/profiles/goes/here")</span></a>
<a class="sourceLine" id="cb42-3" title="3"><span class="co"># my_vplist contains after running the command a list of vertical profile (vp) objects</span></a>
<a class="sourceLine" id="cb42-4" title="4"><span class="co"># To save time, we load these data directly from file</span></a>
<a class="sourceLine" id="cb42-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/load">load</a></span>(<span class="st">"KBRO20170514.RData"</span>)</a>
<a class="sourceLine" id="cb42-6" title="6"><span class="co"># print the length of the vplist object. It should contain 95 profiles</span></a>
<a class="sourceLine" id="cb42-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(my_vplist)</a></code></pre></div>
<pre><code>## [1] 115</code></pre>
</div>
<div id="inspecting-single-vertical-profiles" class="section level3">
<h3 class="hasAnchor">
<a href="#inspecting-single-vertical-profiles" class="anchor"></a>2.2 Inspecting single vertical profiles</h3>
<p>Now that you have loaded a list of vertical profiles, we can start exploring them. We will start with plotting and inspecting single vertical profiles, i.e. a single profile from the list of vp objects you have just loaded.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="co"># let's extract a profile from the list, in this example the 41st profile:</span></a>
<a class="sourceLine" id="cb44-2" title="2">my_vp &lt;-<span class="st"> </span>my_vplist[[<span class="dv">41</span>]]</a>
<a class="sourceLine" id="cb44-3" title="3"><span class="co"># print some info for this profile to the console</span></a>
<a class="sourceLine" id="cb44-4" title="4">my_vp</a></code></pre></div>
<pre><code>##                Vertical profile (class vp)
## 
##        radar:  KBRO 
##       source:  RAD:KBGM,PLC:Brownsville 
## nominal time:  2017-05-14 05:58:00 
## generated by:  vol2bird 0.3.17</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="co"># test whether this profile was collected at day time:</span></a>
<a class="sourceLine" id="cb46-2" title="2"><span class="kw"><a href="../reference/check_night.html">check_night</a></span>(my_vp)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="co"># plot the vertical profile, in terms of reflectivity factor</span></a>
<a class="sourceLine" id="cb48-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my_vp, <span class="dt">quantity =</span> <span class="st">"dbz"</span>)</a></code></pre></div>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="co"># plot the vertical profile, in terms of (linear) reflectivity</span></a>
<a class="sourceLine" id="cb49-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my_vp, <span class="dt">quantity =</span> <span class="st">"eta"</span>)</a></code></pre></div>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-18-2.png" width="700"></p>
<p><code>eta</code> and <code>dbz</code> are closely related, the main difference is that reflectivity factors are logarithmic, and reflectivities linear. You can convert one into the other using <code><a href="../reference/eta_to_dbz.html">eta_to_dbz()</a></code> and <code><a href="../reference/dbz_to_eta.html">dbz_to_eta()</a></code> functions, which follow this simple formula:</p>
<pre><code>eta = (radar-wavelength dependent constant) * 10^(dbz/10)</code></pre>
<p>The reflectivity factor <code>dBZ</code> is the quantity used by most meteorologist. It has the useful property that at different radar wavelengths (e.g. S-band versus C-band) the same amount of precipitation shows up at similar reflectivity factors. The same holds for insects, as well as any other target that is much smaller than the radar wavelength (S-band = 10 cm, C-band = 5 cm), the so-called Rayleigh-scattering limit.</p>
<p>In the case of birds we are outside the Rayleigh limit, because birds are of similar size as the radar wavelength. In this limit reflectivity <code>eta</code> is more similar between S-band and C-band. <code>eta</code> is also more directly related to the density of birds, since <code>eta</code> can be expressed as (bird density) x (radar cross section per bird). For these two reasons, for weather radar ornithologists not reflectivity factor <code>dBZ</code> but reflectivity <code>eta</code> is the more conventional unit.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="co"># let'splot the vertical profile, in terms of bird density</span></a>
<a class="sourceLine" id="cb51-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my_vp, <span class="dt">quantity =</span> <span class="st">"dens"</span>)</a></code></pre></div>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="co"># print the currently assumed radar cross section (RCS) per bird:</span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw"><a href="../reference/rcs.html">rcs</a></span>(my_vp)</a></code></pre></div>
<pre><code>## [1] 11</code></pre>
<p><strong>Exercise 4:</strong> If you change your assumption on the bird’s radar cross section in the previous example, and assume it is 10 times as large, what will be the effect on the bird density profile?</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="co"># Answer:</span></a>
<a class="sourceLine" id="cb54-2" title="2"><span class="co"># All bird densities will be a factor 10 times lower.</span></a></code></pre></div>
<p>The radar cross section you assume can be changed as follows:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="co"># let's change the RCS to 110 cm^2</span></a>
<a class="sourceLine" id="cb55-2" title="2"><span class="kw"><a href="../reference/rcs.html">rcs</a></span>(my_vp) &lt;-<span class="st"> </span><span class="dv">110</span></a></code></pre></div>
<p><strong>Exercise 5:</strong> Verify your answers on the previous two questions, by re-plotting the vertical profiles for the bird density quantity.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="co"># After changing the RCS above, we simply plot the vertical profile again</span></a>
<a class="sourceLine" id="cb56-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my_vp)</a></code></pre></div>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="co"># Indeed the densities are scaled down by a factor 10</span></a></code></pre></div>
</div>
<div id="plotting-vertical-profile-time-series" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting-vertical-profile-time-series" class="anchor"></a>2.3 Plotting vertical profile time series</h3>
<p>We will now examine multiple vertical profiles at once that are ordered into a time series, e.g. the vertical profiles obtained from a single radar over a full day.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="co"># convert the list of vertical profiles into a time series:</span></a>
<a class="sourceLine" id="cb58-2" title="2">my_vpts &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bind_into_vpts.html">bind_into_vpts</a></span>(my_vplist)</a>
<a class="sourceLine" id="cb58-3" title="3"><span class="co"># print summary information</span></a>
<a class="sourceLine" id="cb58-4" title="4">my_vpts</a></code></pre></div>
<pre><code>##                    Irregular time series of vertical profiles (class vpts)
## 
##            radar:  KBRO 
##       # profiles:  115 
## time range (UTC):  2017-05-14 00:09:00 - 2017-05-14 23:34:00 
##    time step (s):  min: 300     max:  2340</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="co"># time series objects can be subsetted, just as you may be used to with vectors</span></a>
<a class="sourceLine" id="cb60-2" title="2"><span class="co"># here we subset the first 50 timesteps:</span></a>
<a class="sourceLine" id="cb60-3" title="3">my_vpts[<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>]</a></code></pre></div>
<pre><code>##                    Irregular time series of vertical profiles (class vpts)
## 
##            radar:  KBRO 
##       # profiles:  50 
## time range (UTC):  2017-05-14 00:09:00 - 2017-05-14 06:54:00 
##    time step (s):  min: 300     max:  1740</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="co"># here we extract a single timestep, which gives you back a vertical profile class object:</span></a>
<a class="sourceLine" id="cb62-2" title="2">my_vpts[<span class="dv">100</span>]</a></code></pre></div>
<pre><code>##                Vertical profile (class vp)
## 
##        radar:  KBRO 
##       source:  RAD:KBGM,PLC:Brownsville 
## nominal time:  2017-05-14 16:03:00 
## generated by:  vol2bird 0.3.17</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="co"># to extract all the dates of all profiles in the time series:</span></a>
<a class="sourceLine" id="cb64-2" title="2">my_vpts<span class="op">$</span>datetime</a></code></pre></div>
<pre><code>##   [1] "2017-05-14 00:09:00 UTC" "2017-05-14 00:28:00 UTC"
##   [3] "2017-05-14 00:57:00 UTC" "2017-05-14 01:07:00 UTC"
##   [5] "2017-05-14 01:17:00 UTC" "2017-05-14 01:27:00 UTC"
##   [7] "2017-05-14 01:36:00 UTC" "2017-05-14 01:46:00 UTC"
##   [9] "2017-05-14 01:56:00 UTC" "2017-05-14 02:06:00 UTC"
##  [11] "2017-05-14 02:15:00 UTC" "2017-05-14 02:25:00 UTC"
##  [13] "2017-05-14 02:35:00 UTC" "2017-05-14 02:45:00 UTC"
##  [15] "2017-05-14 02:54:00 UTC" "2017-05-14 03:04:00 UTC"
##  [17] "2017-05-14 03:14:00 UTC" "2017-05-14 03:24:00 UTC"
##  [19] "2017-05-14 03:33:00 UTC" "2017-05-14 03:43:00 UTC"
##  [21] "2017-05-14 03:53:00 UTC" "2017-05-14 04:03:00 UTC"
##  [23] "2017-05-14 04:12:00 UTC" "2017-05-14 04:22:00 UTC"
##  [25] "2017-05-14 04:32:00 UTC" "2017-05-14 04:37:00 UTC"
##  [27] "2017-05-14 04:43:00 UTC" "2017-05-14 04:48:00 UTC"
##  [29] "2017-05-14 04:53:00 UTC" "2017-05-14 04:59:00 UTC"
##  [31] "2017-05-14 05:04:00 UTC" "2017-05-14 05:10:00 UTC"
##  [33] "2017-05-14 05:15:00 UTC" "2017-05-14 05:20:00 UTC"
##  [35] "2017-05-14 05:26:00 UTC" "2017-05-14 05:31:00 UTC"
##  [37] "2017-05-14 05:37:00 UTC" "2017-05-14 05:42:00 UTC"
##  [39] "2017-05-14 05:47:00 UTC" "2017-05-14 05:53:00 UTC"
##  [41] "2017-05-14 05:58:00 UTC" "2017-05-14 06:03:00 UTC"
##  [43] "2017-05-14 06:09:00 UTC" "2017-05-14 06:14:00 UTC"
##  [45] "2017-05-14 06:20:00 UTC" "2017-05-14 06:25:00 UTC"
##  [47] "2017-05-14 06:30:00 UTC" "2017-05-14 06:36:00 UTC"
##  [49] "2017-05-14 06:48:00 UTC" "2017-05-14 06:54:00 UTC"
##  [51] "2017-05-14 06:59:00 UTC" "2017-05-14 07:05:00 UTC"
##  [53] "2017-05-14 07:10:00 UTC" "2017-05-14 07:15:00 UTC"
##  [55] "2017-05-14 07:21:00 UTC" "2017-05-14 07:26:00 UTC"
##  [57] "2017-05-14 07:31:00 UTC" "2017-05-14 07:37:00 UTC"
##  [59] "2017-05-14 07:42:00 UTC" "2017-05-14 07:48:00 UTC"
##  [61] "2017-05-14 07:53:00 UTC" "2017-05-14 07:58:00 UTC"
##  [63] "2017-05-14 08:04:00 UTC" "2017-05-14 08:09:00 UTC"
##  [65] "2017-05-14 08:14:00 UTC" "2017-05-14 08:20:00 UTC"
##  [67] "2017-05-14 08:25:00 UTC" "2017-05-14 08:31:00 UTC"
##  [69] "2017-05-14 08:36:00 UTC" "2017-05-14 08:41:00 UTC"
##  [71] "2017-05-14 08:47:00 UTC" "2017-05-14 08:52:00 UTC"
##  [73] "2017-05-14 08:57:00 UTC" "2017-05-14 09:03:00 UTC"
##  [75] "2017-05-14 09:08:00 UTC" "2017-05-14 09:14:00 UTC"
##  [77] "2017-05-14 09:23:00 UTC" "2017-05-14 09:33:00 UTC"
##  [79] "2017-05-14 09:43:00 UTC" "2017-05-14 09:53:00 UTC"
##  [81] "2017-05-14 10:02:00 UTC" "2017-05-14 10:12:00 UTC"
##  [83] "2017-05-14 10:22:00 UTC" "2017-05-14 10:32:00 UTC"
##  [85] "2017-05-14 10:41:00 UTC" "2017-05-14 10:51:00 UTC"
##  [87] "2017-05-14 11:01:00 UTC" "2017-05-14 11:11:00 UTC"
##  [89] "2017-05-14 11:20:00 UTC" "2017-05-14 11:30:00 UTC"
##  [91] "2017-05-14 11:40:00 UTC" "2017-05-14 11:59:00 UTC"
##  [93] "2017-05-14 12:29:00 UTC" "2017-05-14 12:56:00 UTC"
##  [95] "2017-05-14 13:25:00 UTC" "2017-05-14 14:04:00 UTC"
##  [97] "2017-05-14 14:33:00 UTC" "2017-05-14 14:55:00 UTC"
##  [99] "2017-05-14 15:34:00 UTC" "2017-05-14 16:03:00 UTC"
## [101] "2017-05-14 16:32:00 UTC" "2017-05-14 17:02:00 UTC"
## [103] "2017-05-14 17:31:00 UTC" "2017-05-14 18:00:00 UTC"
## [105] "2017-05-14 18:29:00 UTC" "2017-05-14 18:59:00 UTC"
## [107] "2017-05-14 19:28:00 UTC" "2017-05-14 19:57:00 UTC"
## [109] "2017-05-14 20:26:00 UTC" "2017-05-14 20:56:00 UTC"
## [111] "2017-05-14 21:25:00 UTC" "2017-05-14 22:04:00 UTC"
## [113] "2017-05-14 22:33:00 UTC" "2017-05-14 23:04:00 UTC"
## [115] "2017-05-14 23:34:00 UTC"</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"><span class="co"># to plot the full time series:</span></a>
<a class="sourceLine" id="cb66-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my_vpts)</a></code></pre></div>
<pre><code>## Warning in plot.vpts(my_vpts): Irregular time-series: missing profiles will
## not be visible.Use 'regularize_vpts' to make time series regular.</code></pre>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="co"># check the help file for the plotting function of profile time series</span></a>
<a class="sourceLine" id="cb68-2" title="2"><span class="co"># Because profile timeseries are of class 'vpts', it's associated plotting function</span></a>
<a class="sourceLine" id="cb68-3" title="3"><span class="co"># is called plot.vpts:</span></a>
<a class="sourceLine" id="cb68-4" title="4">?plot.vpts</a></code></pre></div>
<p>Let’s make a plot for a subselection of the time series:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="co"># make a subselection for night time only</span></a>
<a class="sourceLine" id="cb69-2" title="2">index_night &lt;-<span class="st"> </span><span class="kw"><a href="../reference/check_night.html">check_night</a></span>(my_vpts)</a>
<a class="sourceLine" id="cb69-3" title="3"><span class="co"># index_night is a logical vector that specifies each profile whether it occurred at night or not:</span></a>
<a class="sourceLine" id="cb69-4" title="4">index_night</a></code></pre></div>
<pre><code>##   [1] FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
##  [12]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
##  [23]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
##  [34]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
##  [45]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
##  [56]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
##  [67]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
##  [78]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
##  [89]  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [100] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [111] FALSE FALSE FALSE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="co"># now subset our vpts using this selection:</span></a>
<a class="sourceLine" id="cb71-2" title="2">my_vpts_night &lt;-<span class="st"> </span>my_vpts[index_night]</a>
<a class="sourceLine" id="cb71-3" title="3"><span class="co"># plot this smaller time series:</span></a>
<a class="sourceLine" id="cb71-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my_vpts_night)</a></code></pre></div>
<pre><code>## Warning in plot.vpts(my_vpts_night): Irregular time-series: missing
## profiles will not be visible.Use 'regularize_vpts' to make time series
## regular.</code></pre>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<p><strong>Exercise 6:</strong> Interpret the wind barbs in the profile time series figure: what is the approximate speed and direction at 1500 meter at 6 UTC? In the speed barbs, each half flag represents 2.5 m/s, each full flag 5 m/s, [each pennant (triangle) 25 m/s, not occurring in this case].</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="co"># Answer:</span></a>
<a class="sourceLine" id="cb73-2" title="2"><span class="co">#</span></a>
<a class="sourceLine" id="cb73-3" title="3"><span class="co"># At 1500 meter 6 UTC the wind barbs have 2 full flags and one half flag.</span></a>
<a class="sourceLine" id="cb73-4" title="4"><span class="co"># Therefore the ground speed is approximately 2x5 + 2.5 = 12.5 m/s.</span></a></code></pre></div>
<p><strong>Exercise 7:</strong> Extract the vertical profile at 6 UTC from the time series and plot the vertical profile of ground speed (quantity <code>ff</code>). Hint: use function <code><a href="../reference/filter_vpts.html">filter_vpts()</a></code> to extract the 6 UTC profile. Check whether your answer to the previous question was approximately correct.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="co"># First extract the profile at 6 UTC:</span></a>
<a class="sourceLine" id="cb74-2" title="2">vp_6UTC &lt;-<span class="st"> </span><span class="kw"><a href="../reference/filter_vpts.html">filter_vpts</a></span>(my_vpts_night, <span class="dt">nearest=</span><span class="st">"2017-05-14 06:00"</span>)</a>
<a class="sourceLine" id="cb74-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(vp_6UTC, <span class="dt">quantity =</span> <span class="st">"ff"</span>)</a></code></pre></div>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"><span class="co"># Plot the ground speed (ff):</span></a>
<a class="sourceLine" id="cb75-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(vp_6UTC, <span class="dt">quantity =</span> <span class="st">"ff"</span>)</a></code></pre></div>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="co"># Speeds at 1500 metre is approximately 12 m/s, very close to our earlier reading above of 12.5 m/s.</span></a></code></pre></div>
</div>
<div id="vertical-and-time-integration-of-profiles" class="section level3">
<h3 class="hasAnchor">
<a href="#vertical-and-time-integration-of-profiles" class="anchor"></a>2.4 Vertical and time integration of profiles</h3>
<p>Often you will want to sum together all the migrants in the vertical dimension, for example if you want a single index of how many birds are migrating at a certain instant. There are at least two ways in which you can do that:</p>
<ul>
<li>by calculating the vertically integrated bird density (VID), which is <em>surface</em> density as opposed to a <em>volume</em> densities you have been plotting in the previous exercises: this number gives you how many migrants are aloft per square kilometer earth’s surface (unit individuals/km<span class="math inline">\(^{2}\)</span>), and is a vertical integration of the volume densities(unit individuals/km<span class="math inline">\(^{3}\)</span>).</li>
<li>Note that the VID quantity doesn’t depend on the speed of the migrants. A common measure that reflects both the density and speed of the migration is migration traffic rate (MTR). This is flux measure that gives you how many migrants are passing the radar station per unit of time and per unit of distance perpendicular to the migratory direction (unit individuals/km/hour).</li>
</ul>
<p>We will be using bioRad’s <code><a href="../reference/integrate_profile.html">integrate_profile()</a></code> function to calculate these quantities:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="co"># Let's continue with the vpts object created in the previous example.</span></a>
<a class="sourceLine" id="cb77-2" title="2"><span class="co"># The vertically integrated quantities are calculated as follows:</span></a>
<a class="sourceLine" id="cb77-3" title="3">my_vpi &lt;-<span class="st"> </span><span class="kw"><a href="../reference/integrate_profile.html">integrate_profile</a></span>(my_vpts)</a>
<a class="sourceLine" id="cb77-4" title="4"><span class="co"># The my_vpi object you created is a vpi class object, which is an acronym for "vertical profile integrated". It has its own plot method, which by default plots migration traffic rate (MTR):</span></a>
<a class="sourceLine" id="cb77-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my_vpi)</a></code></pre></div>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="co"># you can also plot vertically integrated densities (VID):</span></a>
<a class="sourceLine" id="cb78-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my_vpi, <span class="dt">quantity =</span> <span class="st">"vid"</span>)</a></code></pre></div>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-28-2.png" width="700"></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="co"># the gray and white shading indicates day and night, which is calculated</span></a>
<a class="sourceLine" id="cb79-2" title="2"><span class="co"># from the date and the radar position. You can also turn this off:</span></a>
<a class="sourceLine" id="cb79-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my_vpi, <span class="dt">night_shade =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-28-3.png" width="700"></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="co"># plot the cumulative number of birds passing the radar, i.e. migration traffic (mt):</span></a>
<a class="sourceLine" id="cb80-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my_vpi, <span class="dt">quantity =</span> <span class="st">"mt"</span>)</a></code></pre></div>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-28-4.png" width="700"></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="co"># execute `?plot.vpi` to open the help page listing all the options.</span></a>
<a class="sourceLine" id="cb81-2" title="2">?plot.vpi</a></code></pre></div>
<p>The following questions only require pen and paper. Assume a night migration event in which the volume density of birds from 0-1 km above ground is 200 birds per cubic kilometer, and from 1-1.5 km 100 birds per cubic kilometer. In the lower layer birds fly at 50 km/hour, and in the upper layer at 100 km/hour. Above 1500 meter there are no birds. Migration continues for exactly three hours after sunset, and then halts abruptly.</p>
<p><strong>Exercise 8:</strong> What is in this case the bird’s vertically integrated density (VID)? Give your answer in units birds/km<span class="math inline">\(^2\)</span>.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="co"># Answer:</span></a>
<a class="sourceLine" id="cb82-2" title="2"><span class="co">#</span></a>
<a class="sourceLine" id="cb82-3" title="3"><span class="co"># VID = (200 birds / km^3) * (1 km) + (100 birds / km^3) * (0.5 km)</span></a>
<a class="sourceLine" id="cb82-4" title="4"><span class="co">#     = 250 birds / km^2</span></a></code></pre></div>
<p><strong>Exercise 9:</strong> What is in this case the migration traffic rate across a transect perpendicular to the direction of movement? Give your answer in units birds/km/hour.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="co"># Answer:</span></a>
<a class="sourceLine" id="cb83-2" title="2"><span class="co">#</span></a>
<a class="sourceLine" id="cb83-3" title="3"><span class="co"># MTR = (200 birds / km^3) * (50 km / hour) * (1 km) + (100 birds / km^3) * (100 km / hour) * (0.5 km)</span></a>
<a class="sourceLine" id="cb83-4" title="4"><span class="co">#     = 10000 birds / km / hour + 5000 birds / km / hour</span></a>
<a class="sourceLine" id="cb83-5" title="5"><span class="co">#     = 15000 birds / km / hour</span></a></code></pre></div>
<p><strong>Exercise 10:</strong> How many birds have passed a 1km transect perpendicular to the direction of movement in this night? Give your answer in terms of migration traffic (mt) in units birds/km.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="co"># Answer:</span></a>
<a class="sourceLine" id="cb84-2" title="2"><span class="co">#</span></a>
<a class="sourceLine" id="cb84-3" title="3"><span class="co"># MT = MTR * (3 hour) = (15000 birds / km / hour) * (3 hour)</span></a>
<a class="sourceLine" id="cb84-4" title="4"><span class="co">#    = 45000 birds / km</span></a></code></pre></div>
<p>Both MTR, VID and MT depend on the assumed radar cross section (RCS) per bird. If you are unwilling/unable to specify RCS, you can alternatively use two closely related quantities that make no assumptions RCS:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="co"># instead of vertically integrated density (VID), you can use vertically integrated reflectivity (VIR):</span></a>
<a class="sourceLine" id="cb85-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my_vpi, <span class="dt">quantity =</span> <span class="st">"vir"</span>)</a></code></pre></div>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="co"># instead of migration traffic rate (MTR), you can use the reflectivity traffic rate (RTR):</span></a>
<a class="sourceLine" id="cb86-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my_vpi, <span class="dt">quantity =</span> <span class="st">"rtr"</span>)</a></code></pre></div>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-32-2.png" width="700"></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="co"># instead of migration traffic (MT), you can use the reflectivity traffic (RT):</span></a>
<a class="sourceLine" id="cb87-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my_vpi, <span class="dt">quantity =</span> <span class="st">"rt"</span>)</a></code></pre></div>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-32-3.png" width="700"></p>
<p>VIR gives you the total cross-sectional area of air-borne targets per square kilometer of ground surface, whereas RTR gives you the total cross-sectional area of targets flying across a one kilometer line perpendicular to the migratory flow per hour.</p>
</div>
<div id="inspecting-precipitation-signals-in-profiles" class="section level3">
<h3 class="hasAnchor">
<a href="#inspecting-precipitation-signals-in-profiles" class="anchor"></a>2.5 Inspecting precipitation signals in profiles</h3>
<p>Precipitation is known to have a major influence on the timing and intensity of migration, therefore it is a useful skill to be able to inspect profiles for presence of precipitation.</p>
<p>Also, although automated bird quantification algorithms become more and more reliable, distinguishing precipitation from birds remains challenging for algorithms in specific cases. It is therefore important to have the skills to inspect suspicious profiles. That may help you to identify potential errors of the automated methods, and prevent your from overinterpreting the data.</p>
<p>An easy way of doing that is plotting the vertical profile of total reflectivity (quantity DBZH), which includes everything: birds, insects and precipitation. Precipitation often has higher reflectivities than birds, and also extends to much higher altitudes.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="co"># load a time series for the KBGM radar in Binghamton, NY</span></a>
<a class="sourceLine" id="cb88-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/load">load</a></span>(<span class="st">"KBGM20170527-20170602.RData"</span>)</a>
<a class="sourceLine" id="cb88-3" title="3"><span class="co"># print the loaded vpts time series for this radar:</span></a>
<a class="sourceLine" id="cb88-4" title="4">my_vpts</a></code></pre></div>
<pre><code>##                    Regular time series of vertical profiles (class vpts)
## 
##            radar:  KBGM 
##       # profiles:  284 
## time range (UTC):  2017-05-27 08:31:00 - 2017-06-02 04:00:00 
##    time step (s):  1770</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="co"># plot the bird density over time:</span></a>
<a class="sourceLine" id="cb90-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my_vpts, <span class="dt">quantity =</span> <span class="st">"dens"</span>)</a></code></pre></div>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
<p><strong>Exercise 11:</strong> Compare the above plot for bird density (quantity <code>dens</code>) with a profile plot for total reflectivity (quantity <code>DBZH</code>, showing birds and precipitation combined). Compare the two plots to visually identify periods and altitude layers with precipitation.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="co"># also show meteorological signals:</span></a>
<a class="sourceLine" id="cb91-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my_vpts, <span class="dt">quantity =</span> <span class="st">"DBZH"</span>)</a></code></pre></div>
<p><img src="rad_aero_19_answers_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="co"># Periods with high reflectivities extending to high altitudes indicate precipitation,</span></a>
<a class="sourceLine" id="cb92-2" title="2"><span class="co"># i.e. second half of the second night, and on and off during the fourth night.</span></a></code></pre></div>
</div>
</div>
<div id="processing-polar-volume-data-into-profiles" class="section level2">
<h2 class="hasAnchor">
<a href="#processing-polar-volume-data-into-profiles" class="anchor"></a>3 Processing polar volume data into profiles</h2>
<div id="obtaining-radar-data" class="section level3">
<h3 class="hasAnchor">
<a href="#obtaining-radar-data" class="anchor"></a>3.1 Obtaining radar data</h3>
<ul>
<li>US NEXRAD polar volume data can be accessed in the <a href="https://s3.amazonaws.com/noaa-nexrad-level2/index.html">Amazon cloud</a>.</li>
<li>European radar data can be accessed at <a href="http://enram.github.io/data-repository/" class="uri">http://enram.github.io/data-repository/</a>. These are processed vertical profiles, the full polar volume data are not openly available for most countries.</li>
</ul>
<p>The names of the radars in the networks can be found here:</p>
<ul>
<li>US: <a href="https://www.roc.noaa.gov/WSR88D/Maps.aspx">NEXRAD network</a>
</li>
<li>Europe: <a href="http://eumetnet.eu/wp-content/themes/aeron-child/observations-programme/current-activities/opera/database/OPERA_Database/index.html">OPERA database</a>
</li>
</ul>
<p>Useful sites for inspecting pre-made movies of the US composite are <a href="http://birdcast.info/live-migration-maps/" class="uri">http://birdcast.info/live-migration-maps/</a> and <a href="http://www.pauljhurtado.com/US_Composite_Radar/" class="uri">http://www.pauljhurtado.com/US_Composite_Radar/</a>.</p>
</div>
<div id="processing-a-single-polar-volume-with-the-vol2bird-algorithm" class="section level3">
<h3 class="hasAnchor">
<a href="#processing-a-single-polar-volume-with-the-vol2bird-algorithm" class="anchor"></a>3.2 Processing a single polar volume with the vol2bird algorithm</h3>
<p>The following steps take you through the process applying the vol2bird algorithm yourself. You need a working installation of Docker (Linux/Mac) or Docker for Windows (<strong>not</strong> Docker Toolbox, this is an older implementation of Docker for Windows operating systems that is not supported).</p>
<p>We will generate vertical profiles with the automated algorithm vol2bird (<a href="https://github.com/adokter/vol2bird" class="uri">https://github.com/adokter/vol2bird</a>), which is included in the bioRad package.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="co"># start your local Docker installation</span></a>
<a class="sourceLine" id="cb93-2" title="2"><span class="co"># we first test whether R can communicate with Docker:</span></a>
<a class="sourceLine" id="cb93-3" title="3"><span class="kw"><a href="../reference/check_docker.html">check_docker</a></span>()</a></code></pre></div>
<p>If you get a “Hello from Docker!” welcome message, everything is working and you can start processing.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="co"># download a polar volume file you want to process and put it in your home directory.</span></a>
<a class="sourceLine" id="cb94-2" title="2">my_file &lt;-<span class="st"> "write_your_file_to_be_processed_here"</span></a>
<a class="sourceLine" id="cb94-3" title="3"><span class="co"># Alternatively, continue with the polar volume that comes with the package:</span></a>
<a class="sourceLine" id="cb94-4" title="4">my_file &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.file">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"volume.h5"</span>, <span class="dt">package =</span> <span class="st">"bioRad"</span>)</a>
<a class="sourceLine" id="cb94-5" title="5"><span class="co"># run vol2bird</span></a>
<a class="sourceLine" id="cb94-6" title="6"><span class="co"># we set autoconf to TRUE, to let vol2bird figure out the optimal settings by itself</span></a>
<a class="sourceLine" id="cb94-7" title="7">my_vp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calculate_vp.html">calculate_vp</a></span>(my_file, <span class="dt">autoconf =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb94-8" title="8"><span class="co"># vp is now a 'vp' profile object, that you can examine as in the previous exercises</span></a>
<a class="sourceLine" id="cb94-9" title="9"><span class="co"># alternatively, you may also store the profile as a hdf5 file, which is what we will do next:</span></a>
<a class="sourceLine" id="cb94-10" title="10"><span class="kw"><a href="../reference/calculate_vp.html">calculate_vp</a></span>(my_file, <span class="st">"my_vpfile.h5"</span>, <span class="dt">autoconf =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb94-11" title="11"><span class="co"># your work directory should now contain a new file 'my_vpfile.h5'</span></a>
<a class="sourceLine" id="cb94-12" title="12"><span class="co"># check that we can read this file, and retrieve the vertical profile from it:</span></a>
<a class="sourceLine" id="cb94-13" title="13">vp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_vpfiles.html">read_vpfiles</a></span>(<span class="st">"my_vpfile.h5"</span>)</a></code></pre></div>
</div>
<div id="processing-multiple-polar-volumes" class="section level3">
<h3 class="hasAnchor">
<a href="#processing-multiple-polar-volumes" class="anchor"></a>3.3 Processing multiple polar volumes</h3>
<p>This section contains an example for processing a directory of polar volumes into profiles:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="co"># read the filenames of the polar volumes you want to process</span></a>
<a class="sourceLine" id="cb95-2" title="2">my_files &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list.files">list.files</a></span>(<span class="st">"your/directory/with/volumes/goes/here/"</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb95-3" title="3"><span class="co"># print the filenames</span></a>
<a class="sourceLine" id="cb95-4" title="4">my_files</a>
<a class="sourceLine" id="cb95-5" title="5"><span class="co"># create output directory for processed profiles</span></a>
<a class="sourceLine" id="cb95-6" title="6">outputdir &lt;-<span class="st"> "~/processed_data"</span></a>
<a class="sourceLine" id="cb95-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/files2">dir.create</a></span>(outputdir)</a>
<a class="sourceLine" id="cb95-8" title="8"><span class="co"># let's loop over the files and generate profiles</span></a>
<a class="sourceLine" id="cb95-9" title="9"><span class="cf">for</span> (file_in <span class="cf">in</span> my_files) {</a>
<a class="sourceLine" id="cb95-10" title="10">  <span class="co"># generate the output filename for the input file</span></a>
<a class="sourceLine" id="cb95-11" title="11">  file_out &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(outputdir, <span class="st">"/"</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/basename">basename</a></span>(file_in), <span class="st">"_vp.h5"</span>, <span class="dt">sep =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb95-12" title="12">  <span class="co"># generate the profile, and write it as a hdf5 file (for later reference)</span></a>
<a class="sourceLine" id="cb95-13" title="13">  <span class="co"># we turn autoconfiguration on, so vol2bird chooses the optimal settings for the file automatically</span></a>
<a class="sourceLine" id="cb95-14" title="14">  vp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calculate_vp.html">calculate_vp</a></span>(file_in, file_out, <span class="dt">autoconf =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb95-15" title="15">}</a></code></pre></div>
<p>Having generated the profiles, we can read them into R:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="co"># we assume outputdir contains the path to the directory with processed profiles</span></a>
<a class="sourceLine" id="cb96-2" title="2">my_vpfiles &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list.files">list.files</a></span>(outputdir, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb96-3" title="3"><span class="co"># print them</span></a>
<a class="sourceLine" id="cb96-4" title="4">my_vpfiles</a>
<a class="sourceLine" id="cb96-5" title="5"><span class="co"># read them</span></a>
<a class="sourceLine" id="cb96-6" title="6">my_vplist &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_vpfiles.html">read_vpfiles</a></span>(my_vpfiles)</a></code></pre></div>
<p>You can now continue with visualizing and post-processing as we did earlier:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="co"># make a time series of profiles:</span></a>
<a class="sourceLine" id="cb97-2" title="2">my_vpts &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bind_into_vpts.html">bind_into_vpts</a></span>(my_vplist)</a>
<a class="sourceLine" id="cb97-3" title="3"><span class="co"># plot them between 0 - 3 km altitude:</span></a>
<a class="sourceLine" id="cb97-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my_vpts, <span class="dt">ylim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">3000</span>))</a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#basic-visualisation-of-radar-scans-in-r">1 Basic visualisation of radar scans in R</a></li>
      <li><a href="#analysis-and-visualisation-of-vertical-bird-profiles">2 Analysis and visualisation of vertical bird profiles</a></li>
      <li><a href="#processing-polar-volume-data-into-profiles">3 Processing polar volume data into profiles</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="http://adriaandokter.com">Adriaan M. Dokter</a>, <a href="https://twitter.com/peterdesmet">Peter Desmet</a>, <a href="https://twitter.com/SVanHoey">Stijn Van Hoey</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '482e77c49caf113078e572738762cf40',
    indexName: 'biorad',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
